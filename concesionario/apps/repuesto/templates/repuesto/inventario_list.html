{% extends "base.html" %}
{% load staticfiles %}

{# Load the tag library #}
{% load bootstrap3 %}

{# Display django.contrib.messages as Bootstrap alerts #}
{% bootstrap_messages %}

{% block css %}
{{ block.super }}
<!-- ================== BEGIN PAGE LEVEL STYLE TABLE================== -->
    <link href="{% static 'color_admin/assets/plugins/DataTables-1.9.4/css/data-table.css' %}" rel="stylesheet" />
    <!-- ================== END PAGE LEVEL STYLE ================== -->
{% endblock %}

{% block breadcrumb %}
Sucursal {{ sucursal.nombre }}
{% endblock %}
{% block section_title %}Gestión de Repuestos{% endblock %}
{% block section_subtitle %}Seleccione un elemento para modificar su información{% endblock %}
{% block content %}
            <!-- begin row -->
            <div class="row">
                <div class="col-md-12">
                    <ul class="nav nav-tabs">
                        <li class="active"><a href="#default-tab-1" data-toggle="tab">Inventario</a></li>
                        <li class=""><a href="#default-tab-2" data-toggle="tab">Añadir al Inventario</a></li>
                    </ul>
                    <div class="tab-content">
                        <div class="tab-pane fade active in" id="default-tab-1">
                            <h3 class="m-t-10"><i class="fa fa-cog"></i> Inventario</h3>
                            <p>
                                <!-- begin panel -->
                                <div class="panel panel-inverse">
                                    <div class="panel-heading">
                                        <div class="panel-heading-btn">
                                            <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i class="fa fa-expand"></i></a>
                                            <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-success" data-click="panel-reload"><i class="fa fa-repeat"></i></a>
                                            <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i class="fa fa-minus"></i></a>
                                            <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-danger" data-click="panel-remove"><i class="fa fa-times"></i></a>
                                        </div>
                                        <h4 class="panel-title">Repuestos</h4>
                                    </div>
                                    <div class="panel-body">
                                        <div class="table-responsive">
                                            <table class="table table-striped table-bordered">
                                                <thead>
                                                    <tr>
                                                        <th>Nombre</th>
                                                        <th>Marca</th>
                                                        <th>Clasificación</th>
                                                        <th>Precio</th>
                                                        <th>Proveedor</th>
                                                        <th>Descripción</th>
                                                        <th>Cantidad</th>
                                                        <th>Habilitado</th>
                                                        <th>Imagen</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                        {% for sucursal_repuesto in sucursal_repuestos %}
                                                                <td><a class="update" href="{% url 'repuesto:actualizar-repuesto-sucursal' sucursal_repuesto.pk %}"> {{ sucursal_repuesto.repuesto.nombre }}</a></td>
                                                                <td>{{ sucursal_repuesto.repuesto.marca }}</td>
                                                                <td>{{ sucursal_repuesto.repuesto.clasificacion }}</td>
                                                                <td>{{ sucursal_repuesto.repuesto.precio }}</td>
                                                                <td>{{ sucursal_repuesto.repuesto.proveedor }}</td>
                                                                <td>{{ sucursal_repuesto.repuesto.descripcion }}</td>
                                                                <td>{{ sucursal_repuesto.cantidad }}</td>
                                                                <td>
                                                                    {% if sucursal_repuesto.habilitado %}
                                                                    <ul class="fa-ul">
                                                                        <li><i class="fa-li fa fa-check-square text-success"></i></li>
                                                                    </ul>
                                                                    {% else %}
                                                                    <ul class="fa-ul">
                                                                        <li><i class="fa-li fa fa-square"></i></li>
                                                                    </ul>
                                                                    {% endif %}
                                                                </td>
                                                                <td>{% if  sucursal_repuesto.repuesto.imagen %}
                                                                        <img src={{ sucursal_repuesto.repuesto.imagen.url }} width=50 height=50 class="media-object rounded-corner" /> 
                                                                    {% else %}
                                                                         <img src="{{ MEDIA_URL }}imagenes/repuestos/sin_img_repuesto.jpg" width=50 height=50 class="media-object rounded-corner" />
                                                                    {% endif %} 
                                                                </td>
                                                            </tr >
                                                        {% endfor %} 
                                                        </ul> 
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <!-- end panel -->
                            </p>
                            
                        </div>
                        <div class="tab-pane fade" id="default-tab-2">
                            <div class="row">
                                <div class="col-md-6">
                                    <blockquote>
                                        <p>Añadir Repuesto al Inventario</p>
                                        <small>De la siguiente <cite title="Source Title">Tabla</cite></small>
                                    </blockquote>
                                    <h4>Seleccione el repuesto que desea añadir al inventario.</h4>
                                </div>
                                <div class="col-md-6">
                                    <p>
                                        <div class="panel panel-inverse">
                                            <div class="panel-heading">
                                                <div class="panel-heading-btn">
                                                    <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i class="fa fa-expand"></i></a>
                                                    <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-success" data-click="panel-reload"><i class="fa fa-repeat"></i></a>
                                                    <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i class="fa fa-minus"></i></a>
                                                    <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-danger" data-click="panel-remove"><i class="fa fa-times"></i></a>
                                                </div>
                                                <h4 class="panel-title">repuestos</h4>
                                            </div>
                                            <div class="panel-body">
                                                <div class="table-responsive">
                                                    <table class="table table-striped table-bordered">
                                                        <thead>
                                                            <tr>
                                                                <th>Nombre</th>
                                                                <th>Marca</th>
                                                                <th>Clasificación</th>
                                                                <th>Imagen</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                        {% for repuesto  in repuestos %}
                                                            <tr>
                                                                <td><a class="create" href="{% url 'repuesto:actualizar' repuesto.pk %}"> {{ repuesto.nombre }} </a></td>
                                                                <td>{{ repuesto.marca }}</td>
                                                                <td>{{ repuesto.clasificacion }}</td>
                                                                <td>{% if  repuesto.imagen %}
                                                                        <img src={{ repuesto.imagen.url }} width=50 height=50 class="media-object rounded-corner"/> 
                                                                    {% else %}
                                                                        <img src="{{ MEDIA_URL }}imagenes/repuestos/sin_img_repuesto.jpg" width=50 height=50 class="media-object rounded-corner" />
                                                                    {% endif %} </td>
                                                            </tr >
                                                        {% endfor %} 
                                                        
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </p>
                                </div>
                            </div>
                        </div>
                        
                    </div>

                    <!-- #modal-dialog -->
                    <div class="modal fade" id="modal-dialog">
                        <div class="modal-dialog">
                            <div class="modal-content">
                            {% if form_mode == "update" %}
                            <form method="post" action="" data-parsley-validate="true" name="form-wizard" enctype="multipart/form-data"> 
                            {% else %}
                            <form method="post" action="{% url 'repuesto:agregar-repuesto-sucursal' sucursal.pk %}" data-parsley-validate="true" name="form-wizard" enctype="multipart/form-data"> 
                            {% endif %}
                                    {% csrf_token %}
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                        <h4 class="modal-title">Nuevo repuesto Inventario</h4>
                                    </div>
                                    <div class="modal-body">
                                        {% bootstrap_form form %}
                                    </div>
                                    <div class="modal-footer">
                                        <a href="javascript:;" class="btn btn-sm btn-white" data-dismiss="modal">Close</a>
                                        <button type="submit" class="btn btn-sm btn-success">Guardar</button>
                                    </div>
                                </form>

                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <!-- end row -->

{% endblock %}

{% block javascript %}
{{ block.super }}
    <script src="{% static 'color_admin/assets/plugins/DataTables-1.9.4/js/jquery.dataTables.js' %}"></script>
    <script src="{% static 'color_admin/assets/plugins/DataTables-1.9.4/js/data-table.js' %}"></script>
    <script src="{% static 'color_admin/assets/js/apps.min.js' %}"></script>
    <script src="{% static 'color_admin/assets/js/inbox.demo.min.js' %}"></script>
    <script src="{% static 'color_admin/assets/js/apps.min.js' %}"></script>
    <script type="text/javascript">
        $('.table').DataTable();
    </script>
    {% if form.errors or form_mode == "update" %}
    <script type="text/javascript">
        $( document ).ready(function() {
            $(".modal").modal('toggle');
        });
    </script>
    {% endif %}
    <script type="text/javascript">
        $( ".create" ).click(function(event){
            event.preventDefault();
            var clickedVehicleId = $(this).attr('href').split("/")[2];
            $( "#id_repuesto" ).val(clickedVehicleId);
            $( "#id_sucursal" ).val({{ sucursal.id }});
            $(".modal").modal('toggle');
        });   
    </script>
{% endblock %}